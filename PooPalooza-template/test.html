<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <title>å»æ‰€åœ°åœ–</title>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>è¡›æ•™</title>

    <!-- Favicons -->
    <link href="images/icon.png" rel="icon">
    <link href="images/icon.png" rel="apple-touch-icon">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">

    <!-- Vendor CSS Files -->
    <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.10.2/fullcalendar.min.css" rel="stylesheet">

    <!-- Main CSS File -->
    <link href="assets/css/main.css" rel="stylesheet">
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/@googlemaps/extended-component-library/0.6.11/index.min.js"></script>
    <style>
          #calendar {
          margin: 0 auto;
          max-width: 900px;
          background-color: #ffffff;
          border-radius: 6px;
          box-shadow: 0 1px 2px #c3c3c3;
          }

          .login-container {
          display: flex;
          justify-content: center;
          align-items: center;
          height: 100vh;
          padding: 20px;
          }
  </style>
</head>
<body>
  <header id="header" class="header d-flex align-items-center fixed-top">
    <div class="container-fluid container-xl d-flex align-items-center">
      <a href="index.html" class="logo d-flex align-items-center me-auto">
        <img src="images/icon.png" alt="">
        <h1 class="sitename">PooPalooza</h1>
      </a>
      <nav id="navmenu" class="navmenu">
        <ul>
          <li><a href="index.html#hero" class="active">ä¸»é </a></li>
          <li class="dropdown">
            <a href="#"><span>åŠŸèƒ½</span> <i class="bi bi-chevron-down toggle-dropdown"></i></a>
            <ul>
              <li><a href="#map">å»æ‰€åœ°åœ–</a></li>
              <li><a href="#education">è¡›æ•™</a></li>
              <li><a href="#aboutus">é—œæ–¼æˆ‘å€‘</a></li>
            </ul>
          </li>
        </ul>
        <i class="mobile-nav-toggle d-xl-none bi bi-list"></i>
      </nav>
      <a class="btn-getstarted" href="#login">ç™»å…¥</a>
      <a class="btn-getstarted" href="#register">è¨»å†Š</a>
    </div>
</header>

    <div class="main-content">
        <div id="map-container">
            <div id="map" style="height: 500px; width: 100%;"></div>
        </div>
    </div>

    <script>
        function initMap() {
            const map = new google.maps.Map(document.getElementById("map"), {
                center: { lat: -34.397, lng: 150.644 },
                zoom: 6,
            });
            const infoWindow = new google.maps.InfoWindow();

            const locationButton = document.createElement("button");
            locationButton.textContent = "ğŸ“ å®šä½åˆ°ç›®å‰ä½ç½®";
            locationButton.classList.add("custom-map-control-button");
            map.controls[google.maps.ControlPosition.TOP_CENTER].push(locationButton);

            locationButton.addEventListener("click", () => {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(
                        (position) => {
                            const pos = {
                                lat: position.coords.latitude,
                                lng: position.coords.longitude,
                            };

                            infoWindow.setPosition(pos);
                            infoWindow.setContent("ğŸ“ ç›®å‰ä½ç½®");
                            infoWindow.open(map);
                            map.setCenter(pos);
                            map.setZoom(15);
                        },
                        (error) => {
                            console.error("ğŸ“ åœ°ç†å®šä½éŒ¯èª¤:", error.message);
                            alert("âŒ ç„¡æ³•å–å¾—æ‚¨çš„ä½ç½®ï¼Œè«‹ç¨å¾Œå†è©¦ï¼");
                        }
                    );
                } else {
                    alert("âŒ æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´åœ°ç†å®šä½åŠŸèƒ½ï¼");
                }
            });
             // åœ°åœ–å‰µå»ºå¾Œï¼Œå‰µå»ºå»æ‰€æ¨™è¨˜
            bathroomLocations.forEach(locationData => {
                createBathroomMarker(map, locationData);
            });
        }

        window.initMap = initMap;
        
        // éåŒæ­¥åŠ è¼‰ Google Maps API
        const script = document.createElement('script');
        script.src = "https://maps.googleapis.com/maps/api/js?key=AIzaSyCeIoWJI9EddO7doHtWuGmKhR7pPp_qqno&libraries=places,marker&callback=initMap";
        script.async = true;
        document.head.appendChild(script);
    </script>
        <style>
          /* ä¸»è¦å…§å®¹å€å¡Š */
          .main-content {
              display: flex; /* å½ˆæ€§ç›’æ¨¡å‹ */
              justify-content: center; /* è®“å…§å®¹æ°´å¹³ç½®ä¸­ */
              align-items: center; /* è®“å…§å®¹å‚ç›´ç½®ä¸­ */
              flex-direction: column; /* å…§å®¹å‚ç›´æ’åˆ— */
              width: 100%; /* ç¢ºä¿å€å¡Šå¡«æ»¿çˆ¶å®¹å™¨ */
              min-height: 500px; /* è¨­å®šå…§å®¹å€åŸŸçš„æœ€å°é«˜åº¦ */
              margin-top: 100px; /* è®“åœ°åœ–èˆ‡ header ä¿æŒè·é›¢ */
              padding: 20px; /* é¿å…å…§å®¹ç·Šè²¼é‚Šç•Œ */
          }
  
          /* åœ°åœ–å®¹å™¨ */
          #map-container {
              width: 80%; /* è¨­å®šåœ°åœ–å¯¬åº¦ */
              max-width: 800px; /* é™åˆ¶æœ€å¤§å¯¬åº¦ */
              height: 500px; /* è¨­å®šå›ºå®šé«˜åº¦ */
              margin: auto; /* è®“åœ°åœ–æ°´å¹³ç½®ä¸­ */
              border: 1px solid #ddd; /* å¢åŠ é‚Šæ¡† */
              border-radius: 10px; /* åœ“è§’é‚Šæ¡† */
              box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.1); /* é™°å½±æ•ˆæœ */
              overflow: hidden; /* é˜²æ­¢å…§å®¹æº¢å‡º */
          }
  
          /* ğŸ”¹ RWDï¼šå°è¢å¹•æ™‚è®“åœ°åœ–é©æ‡‰ */
          @media (max-width: 768px) {
              .main-content {
                  margin-top: 120px; /* æ‰‹æ©Ÿç‰ˆå¢åŠ é–“è· */
              }
              #map-container {
                  width: 95%; /* æ‰‹æ©Ÿç‰ˆè®“åœ°åœ–æ›´å¯¬ */
                  height: 400px; /* é¿å…åœ°åœ–éé«˜ */
              }
          }
          .bathroom-marker {
            /* æ¨™è¨˜å…§å®¹çš„æ¨£å¼ */
            background-color: white; /* ç¤ºä¾‹ */
            border: 1px solid #ccc; /* ç¤ºä¾‹ */
            padding: 2px; /* ç¤ºä¾‹ */
            border-radius: 4px; /* ç¤ºä¾‹ */
            }

      </style>
      <script>
            const bathroomLocations = [
                {
                    position: { lat: 37.7749, lng: -122.4194 },  // èˆŠé‡‘å±±
                    title: "å…¬å…±å»æ‰€ - è¯åˆå»£å ´",
                    description: "ä¹¾æ·¨ä¸”ç¶­è­·è‰¯å¥½ã€‚",
                },
                {
                    position: { lat: 37.7833, lng: -122.409 },  // å¦ä¸€å€‹ç¤ºä¾‹
                    title: "æ˜Ÿå·´å…‹å»æ‰€",
                    description: "éœ€è¦è³¼è²·æ‰èƒ½é€²å…¥ã€‚",
                },
                // åœ¨æ­¤æ·»åŠ æ›´å¤šå»æ‰€ä½ç½®...
                ];
                function createBathroomMarker(map, locationData) {
                    const marker = new google.maps.marker.AdvancedMarkerElement({
                        map,
                        position: locationData.position,
                        title: locationData.title, // è¨­ç½®æ¨™é¡Œå±¬æ€§
                    });

                    // æ·»åŠ è‡ªå®šç¾©åœ–æ¨™
                    const content = document.createElement("div");
                    content.classList.add("bathroom-marker"); // æ·»åŠ é¡ä»¥é€²è¡Œæ¨£å¼è¨­ç½®
                    content.innerHTML = `<img src="images/bathroom-icon.png" alt="${locationData.title}" style="width: 24px; height: 24px;">`; // ç¤ºä¾‹è‡ªå®šç¾©åœ–æ¨™

                    marker.content = content;

                    // æ·»åŠ ä¿¡æ¯çª—å£åŠŸèƒ½
                    const infoWindow = new google.maps.InfoWindow({
                        content: `<strong>${locationData.title}</strong><br>${locationData.description}`,
                    });

                    marker.addListener("click", () => {
                        infoWindow.open(map, marker);
                    });

                    return marker;
                }
                function findNearbyRestrooms(map, location) {
                    const service = new google.maps.places.PlacesService(map);
                    const request = {
                        location: location,
                        radius: 1000, // åœ¨1000ç±³å…§æœç´¢
                        type: 'restroom' // æˆ– 'toilet', 'bathroom'
                    };

                    service.nearbySearch(request, (results, status) => {
                        if (status === google.maps.places.PlacesServiceStatus.OK) {
                        results.forEach(place => {
                            // å°‡å ´æ‰€æ•¸æ“šè½‰æ›ç‚ºèˆ‡ createBathroomMarker ç›¸å®¹çš„æ ¼å¼
                            const locationData = {
                            position: place.geometry.location,
                            title: place.name,
                            description: place.vicinity || "ç„¡æè¿°å¯ç”¨"
                            };

                            // ç¾åœ¨å¯ä»¥ä½¿ç”¨ createBathroomMarker å‰µå»ºæ¨™è¨˜
                            createBathroomMarker(map, locationData);
                        });
                        }
                    });
                    }

      </script>
</body>
</html>
